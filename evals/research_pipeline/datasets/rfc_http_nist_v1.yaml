id: rfc_http_nist_v1
docs:
  - id: rfc8446
    title: "RFC 8446 - The Transport Layer Security (TLS) Protocol Version 1.3"
    url: "https://www.rfc-editor.org/rfc/pdfrfc/rfc8446.txt.pdf"
  - id: rfc9110
    title: "RFC 9110 - HTTP Semantics"
    url: "https://www.rfc-editor.org/rfc/rfc9110.pdf"
  - id: nist-sp800-63b-4
    title: "NIST SP 800-63B-4 - Digital Identity Guidelines: Authentication and Authenticator Management"
    url: "https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-63B-4.pdf"

tests:
  - id: tls13-renegotiation
    doc_id: rfc8446
    query: "Is renegotiation possible when TLS 1.3 has been negotiated?"
    expected:
      type: contains
      text: "renegotiation is not possible when TLS 1.3 has been negotiated"

  - id: tls13-legacy-renegotiation-serverhello
    doc_id: rfc8446
    query: "What must a legacy TLS client do if it receives a TLS 1.3 ServerHello during renegotiation?"
    expected:
      type: contains
      text: "abort the handshake with a \"protocol_version\" alert"

  - id: tls13-0rtt-replay-layer
    doc_id: rfc8446
    query: "Can replay attacks for 0-RTT be fully prevented at the TLS layer?"
    expected:
      type: contains
      text: "cannot be prevented at the TLS layer"

  - id: http-purpose
    doc_id: rfc9110
    query: "What kind of protocol is HTTP?"
    expected:
      type: contains
      text: "family of stateless, application-level, request/response protocols"

  - id: http-obsoletes
    doc_id: rfc9110
    query: "Which RFCs does RFC 9110 obsolete?"
    expected:
      type: contains
      text: "obsoletes RFCs 2818, 7231, 7232, 7233, 7235, 7538, 7615, 7694, and portions of 7230"

  - id: http-safe-idempotent
    doc_id: rfc9110
    query: "Which methods are both safe and idempotent?"
    expected:
      type: regex
      pattern: '(?i)\\bHEAD\\b.*\\bOPTIONS\\b.*\\bTRACE\\b|\\bOPTIONS\\b.*\\bHEAD\\b.*\\bTRACE\\b'

  - id: nist-aal1-factors
    doc_id: nist-sp800-63b-4
    query: "What does AAL1 require regarding authentication factors?"
    expected:
      type: contains
      text: "AAL1 requires either single-factor or multi-factor"

  - id: nist-aal1-timeouts
    doc_id: nist-sp800-63b-4
    query: "What are the two types of timeouts described for reauthentication?"
    expected:
      type: contains
      text: "overall timeout"

  - id: nist-aal1-30-days
    doc_id: nist-sp800-63b-4
    query: "What is the recommended maximum overall reauthentication timeout at AAL1?"
    expected:
      type: contains
      text: "no more than 30 days"

  - id: nist-password-salt-32-bits
    doc_id: nist-sp800-63b-4
    query: "What minimum salt length is required for stored password hashes?"
    expected:
      type: contains
      text: "salt SHALL be at least 32 bits"
